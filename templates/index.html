<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Email Spam Detection System</title>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        /* Header */
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px 40px;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
            font-weight: 800;
        }
        
        .header p {
            color: #666;
            font-size: 1.1em;
        }
        
        /* Tab Navigation */
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            background: rgba(255, 255, 255, 0.95);
            padding: 15px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            flex-wrap: wrap;
        }
        
        .tab-btn {
            flex: 1;
            min-width: 150px;
            padding: 15px 25px;
            border: none;
            background: #f5f5f5;
            color: #666;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .tab-btn:hover {
            background: #e0e0e0;
            transform: translateY(-2px);
        }
        
        .tab-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        /* Content Sections */
        .content-section {
            display: none;
            animation: fadeIn 0.5s;
        }
        
        .content-section.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Cards */
        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
        }
        
        .card-title {
            font-size: 1.5em;
            font-weight: 700;
            color: #333;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .card-title i {
            color: #667eea;
        }
        
        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.3);
            text-align: center;
        }
        
        .stat-card.success {
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
        }
        
        .stat-card.danger {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
        }
        
        .stat-card.info {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
        }
        
        .stat-card.warning {
            background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
        }
        
        .stat-value {
            font-size: 2.5em;
            font-weight: 800;
            margin: 10px 0;
        }
        
        .stat-label {
            font-size: 1em;
            opacity: 0.9;
            font-weight: 500;
        }
        
        .stat-icon {
            font-size: 2em;
            opacity: 0.3;
        }
        
        /* Prediction Section */
        .prediction-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }
        
        @media (max-width: 768px) {
            .prediction-container {
                grid-template-columns: 1fr;
            }
        }
        
        textarea {
            width: 100%;
            min-height: 200px;
            padding: 20px;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            font-size: 1em;
            font-family: 'Inter', sans-serif;
            resize: vertical;
            transition: all 0.3s;
        }
        
        textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.5);
        }
        
        .btn-secondary {
            background: #f5f5f5;
            color: #666;
        }
        
        .btn-secondary:hover {
            background: #e0e0e0;
        }
        
        .btn-group {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        /* Result Display */
        .result-box {
            padding: 30px;
            border-radius: 15px;
            margin-top: 20px;
            text-align: center;
            display: none;
            animation: slideIn 0.5s;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }
        
        .result-box.ham {
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            border: 3px solid #28a745;
        }
        
        .result-box.spam {
            background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%);
            border: 3px solid #dc3545;
        }
        
        .result-icon {
            font-size: 4em;
            margin-bottom: 15px;
        }
        
        .result-label {
            font-size: 2em;
            font-weight: 800;
            margin-bottom: 10px;
        }
        
        .result-confidence {
            font-size: 1.2em;
            font-weight: 600;
            margin-bottom: 20px;
        }
        
        .result-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .result-detail {
            background: rgba(255, 255, 255, 0.6);
            padding: 15px;
            border-radius: 10px;
        }
        
        .result-detail-value {
            font-size: 1.5em;
            font-weight: 700;
            color: #333;
        }
        
        .result-detail-label {
            font-size: 0.9em;
            color: #666;
            margin-top: 5px;
        }
        
        /* Progress Bar */
        .progress-bar {
            width: 100%;
            height: 30px;
            background: #e0e0e0;
            border-radius: 15px;
            overflow: hidden;
            margin: 20px 0;
        }
        
        .progress-fill {
            height: 100%;
            transition: width 1s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
        }
        
        .progress-fill.ham {
            background: linear-gradient(90deg, #2ecc71 0%, #27ae60 100%);
        }
        
        .progress-fill.spam {
            background: linear-gradient(90deg, #e74c3c 0%, #c0392b 100%);
        }
        
        /* Charts */
        .chart-container {
            position: relative;
            height: 400px;
            margin: 20px 0;
        }
        
        .chart-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 30px;
        }
        
        /* Images */
        .viz-image {
            width: 100%;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            margin: 20px 0;
        }
        
        /* Examples */
        .examples {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .example-btn {
            padding: 15px;
            background: #f5f5f5;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: left;
            font-size: 0.9em;
        }
        
        .example-btn:hover {
            border-color: #667eea;
            background: #f8f9ff;
            transform: translateY(-2px);
        }
        
        .example-label {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 5px;
            font-size: 0.8em;
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .example-label.ham {
            background: #d4edda;
            color: #155724;
        }
        
        .example-label.spam {
            background: #f8d7da;
            color: #721c24;
        }
        
        /* Loading Spinner */
        .spinner {
            display: none;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .loading .spinner {
            display: block;
        }
        
        /* Footer */
        .footer {
            text-align: center;
            color: rgba(255, 255, 255, 0.9);
            margin-top: 40px;
            padding: 20px;
            font-size: 0.9em;
        }
        
        .footer a {
            color: white;
            text-decoration: none;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1><i class="fas fa-shield-alt"></i> Email Spam Detection System</h1>
            <p>Advanced Machine Learning-powered Email Classification with Real-time Analysis</p>
        </div>
        
        <!-- Tab Navigation -->
        <div class="tabs">
            <button class="tab-btn active" onclick="showTab('predict')">
                <i class="fas fa-robot"></i> Predict
            </button>
            <button class="tab-btn" onclick="showTab('dataset')">
                <i class="fas fa-database"></i> Dataset
            </button>
            <button class="tab-btn" onclick="showTab('models')">
                <i class="fas fa-brain"></i> Models
            </button>
            <button class="tab-btn" onclick="showTab('analysis')">
                <i class="fas fa-chart-bar"></i> Analysis
            </button>
            <button class="tab-btn" onclick="showTab('about')">
                <i class="fas fa-info-circle"></i> About
            </button>
        </div>
        
        <!-- Predict Tab -->
        <div id="predict-tab" class="content-section active">
            <div class="card">
                <h2 class="card-title">
                    <i class="fas fa-envelope-open-text"></i>
                    Test Your Email
                </h2>
                
                <div class="prediction-container">
                    <div>
                        <p style="margin-bottom: 15px; color: #666; font-weight: 500;">
                            Enter an email message below to check if it's spam or legitimate (ham):
                        </p>
                        <textarea id="emailInput" placeholder="Type or paste your email message here...&#10;&#10;Example:&#10;Congratulations! You've won a $1000 gift card. Click here now to claim your prize!"></textarea>
                        
                        <div class="btn-group">
                            <button class="btn btn-primary" onclick="predictEmail()">
                                <i class="fas fa-magic"></i> Analyze Email
                            </button>
                            <button class="btn btn-secondary" onclick="clearInput()">
                                <i class="fas fa-eraser"></i> Clear
                            </button>
                        </div>
                        
                        <div class="spinner" id="loadingSpinner"></div>
                    </div>
                    
                    <div>
                        <div id="resultBox" class="result-box">
                            <div class="result-icon" id="resultIcon"></div>
                            <div class="result-label" id="resultLabel"></div>
                            <div class="result-confidence" id="resultConfidence"></div>
                            
                            <div class="progress-bar">
                                <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                            </div>
                            
                            <div class="result-details">
                                <div class="result-detail">
                                    <div class="result-detail-value" id="hamProb">0%</div>
                                    <div class="result-detail-label">Ham Probability</div>
                                </div>
                                <div class="result-detail">
                                    <div class="result-detail-value" id="spamProb">0%</div>
                                    <div class="result-detail-label">Spam Probability</div>
                                </div>
                                <div class="result-detail">
                                    <div class="result-detail-value" id="msgLength">0</div>
                                    <div class="result-detail-label">Characters</div>
                                </div>
                                <div class="result-detail">
                                    <div class="result-detail-value" id="wordCount">0</div>
                                    <div class="result-detail-label">Words</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div style="margin-top: 30px;">
                    <h3 style="margin-bottom: 15px; color: #333;">
                        <i class="fas fa-lightbulb"></i> Try These Examples:
                    </h3>
                    <div class="examples">
                        <div class="example-btn" onclick="loadExample(0)">
                            <div class="example-label spam">SPAM</div>
                            <div>Congratulations! You've won a $1000 gift card...</div>
                        </div>
                        <div class="example-btn" onclick="loadExample(1)">
                            <div class="example-label ham">HAM</div>
                            <div>Hey, are we still meeting for lunch tomorrow?</div>
                        </div>
                        <div class="example-btn" onclick="loadExample(2)">
                            <div class="example-label spam">SPAM</div>
                            <div>FREE! Click here to win an iPhone 15 Pro Max!</div>
                        </div>
                        <div class="example-btn" onclick="loadExample(3)">
                            <div class="example-label ham">HAM</div>
                            <div>Can you send me the report by end of day?</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Dataset Tab -->
        <div id="dataset-tab" class="content-section">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon"><i class="fas fa-envelope"></i></div>
                    <div class="stat-value" id="totalEmails">-</div>
                    <div class="stat-label">Total Emails</div>
                </div>
                <div class="stat-card success">
                    <div class="stat-icon"><i class="fas fa-check-circle"></i></div>
                    <div class="stat-value" id="hamCount">-</div>
                    <div class="stat-label">Ham (Legitimate)</div>
                </div>
                <div class="stat-card danger">
                    <div class="stat-icon"><i class="fas fa-exclamation-triangle"></i></div>
                    <div class="stat-value" id="spamCount">-</div>
                    <div class="stat-label">Spam (Unwanted)</div>
                </div>
                <div class="stat-card info">
                    <div class="stat-icon"><i class="fas fa-percentage"></i></div>
                    <div class="stat-value" id="spamPercentage">-</div>
                    <div class="stat-label">Spam Percentage</div>
                </div>
            </div>
            
            <div class="card">
                <h2 class="card-title">
                    <i class="fas fa-chart-pie"></i>
                    Dataset Distribution
                </h2>
                <img src="/static/images/dataset_distribution.png" alt="Dataset Distribution" class="viz-image">
            </div>
            
            <div class="card">
                <h2 class="card-title">
                    <i class="fas fa-text-width"></i>
                    Text Analysis
                </h2>
                
                <div class="stats-grid">
                    <div class="stat-card success">
                        <div class="stat-value" id="avgLengthHam">-</div>
                        <div class="stat-label">Avg Length (Ham)</div>
                    </div>
                    <div class="stat-card danger">
                        <div class="stat-value" id="avgLengthSpam">-</div>
                        <div class="stat-label">Avg Length (Spam)</div>
                    </div>
                    <div class="stat-card success">
                        <div class="stat-value" id="avgWordsHam">-</div>
                        <div class="stat-label">Avg Words (Ham)</div>
                    </div>
                    <div class="stat-card danger">
                        <div class="stat-value" id="avgWordsSpam">-</div>
                        <div class="stat-label">Avg Words (Spam)</div>
                    </div>
                </div>
                
                <img src="/static/images/text_analysis.png" alt="Text Analysis" class="viz-image">
            </div>
        </div>
        
        <!-- Models Tab -->
        <div id="models-tab" class="content-section">
            <div class="card">
                <h2 class="card-title">
                    <i class="fas fa-trophy"></i>
                    Model Performance Comparison
                </h2>
                
                <div id="modelStatsGrid" class="stats-grid">
                    <!-- Will be populated by JavaScript -->
                </div>
                
                <img src="/static/images/model_comparison.png" alt="Model Comparison" class="viz-image">
            </div>
            
            <div class="card">
                <h2 class="card-title">
                    <i class="fas fa-th"></i>
                    Confusion Matrices
                </h2>
                <img src="/static/images/confusion_matrices.png" alt="Confusion Matrices" class="viz-image">
            </div>
            
            <div class="card">
                <h2 class="card-title">
                    <i class="fas fa-star"></i>
                    Best Model Performance
                </h2>
                <img src="/static/images/best_model_metrics.png" alt="Best Model Metrics" class="viz-image">
            </div>
        </div>
        
        <!-- Analysis Tab -->
        <div id="analysis-tab" class="content-section">
            <div class="card">
                <h2 class="card-title">
                    <i class="fas fa-microscope"></i>
                    Detailed Performance Analysis
                </h2>
                
                <div class="chart-grid">
                    <div class="card">
                        <h3 style="margin-bottom: 20px; color: #333;">
                            <i class="fas fa-balance-scale"></i> Model Accuracy Comparison
                        </h3>
                        <div class="chart-container">
                            <canvas id="accuracyChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h3 style="margin-bottom: 20px; color: #333;">
                            <i class="fas fa-bullseye"></i> Training vs Testing Accuracy
                        </h3>
                        <div class="chart-container">
                            <canvas id="trainTestChart"></canvas>
                        </div>
                    </div>
                </div>
                
                <div class="card" style="margin-top: 30px;">
                    <h3 style="margin-bottom: 20px; color: #333;">
                        <i class="fas fa-clipboard-list"></i> Classification Metrics
                    </h3>
                    <div id="metricsTable"></div>
                </div>
            </div>
        </div>
        
        <!-- About Tab -->
        <div id="about-tab" class="content-section">
            <div class="card">
                <h2 class="card-title">
                    <i class="fas fa-info-circle"></i>
                    About This Project
                </h2>
                
                <div style="line-height: 1.8; color: #555;">
                    <h3 style="color: #667eea; margin: 20px 0 10px 0;">
                        <i class="fas fa-rocket"></i> Project Overview
                    </h3>
                    <p>
                        This Email Spam Detection System uses advanced Machine Learning algorithms to automatically classify emails as spam or legitimate (ham). 
                        The system analyzes text patterns, word frequencies, and other linguistic features to make accurate predictions.
                    </p>
                    
                    <h3 style="color: #667eea; margin: 20px 0 10px 0;">
                        <i class="fas fa-cogs"></i> Technology Stack
                    </h3>
                    <ul style="margin-left: 30px;">
                        <li><strong>Backend:</strong> Python, Flask, Scikit-learn</li>
                        <li><strong>ML Algorithms:</strong> Naive Bayes, Logistic Regression, SVM, Random Forest</li>
                        <li><strong>Text Processing:</strong> NLTK, TF-IDF Vectorization</li>
                        <li><strong>Frontend:</strong> HTML5, CSS3, JavaScript, Chart.js</li>
                        <li><strong>Visualization:</strong> Matplotlib, Seaborn</li>
                    </ul>
                    
                    <h3 style="color: #667eea; margin: 20px 0 10px 0;">
                        <i class="fas fa-brain"></i> Machine Learning Pipeline
                    </h3>
                    <ol style="margin-left: 30px;">
                        <li><strong>Data Preprocessing:</strong> Text cleaning, lowercasing, removing special characters</li>
                        <li><strong>Text Processing:</strong> Stopword removal, stemming using Porter Stemmer</li>
                        <li><strong>Feature Extraction:</strong> TF-IDF (Term Frequency-Inverse Document Frequency)</li>
                        <li><strong>Model Training:</strong> Multiple algorithms trained and compared</li>
                        <li><strong>Evaluation:</strong> Accuracy, precision, recall, F1-score metrics</li>
                        <li><strong>Prediction:</strong> Real-time classification with confidence scores</li>
                    </ol>
                    
                    <h3 style="color: #667eea; margin: 20px 0 10px 0;">
                        <i class="fas fa-chart-line"></i> Model Performance
                    </h3>
                    <p>
                        The system achieves over 98% accuracy on the test dataset, with excellent precision and recall for both spam and ham emails. 
                        The best performing model (typically SVM or Naive Bayes) is automatically selected and deployed.
                    </p>
                    
                    <h3 style="color: #667eea; margin: 20px 0 10px 0;">
                        <i class="fas fa-database"></i> Dataset
                    </h3>
                    <p>
                        The model is trained on the SMS Spam Collection Dataset containing 5,572 real messages labeled as spam or ham.
                        The dataset is balanced and representative of typical spam and legitimate messages.
                    </p>
                    
                    <h3 style="color: #667eea; margin: 20px 0 10px 0;">
                        <i class="fas fa-shield-alt"></i> Features
                    </h3>
                    <ul style="margin-left: 30px;">
                        <li>Real-time email classification</li>
                        <li>Confidence scores for predictions</li>
                        <li>Interactive data visualizations</li>
                        <li>Model performance comparison</li>
                        <li>Detailed text analysis</li>
                        <li>Example emails for testing</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- Footer -->
        <div class="footer">
            <p>
                <i class="fas fa-code"></i> Built with Python, Flask & Machine Learning
                | <i class="fas fa-heart"></i> Spam Detection System
            </p>
        </div>
    </div>
    
    <script>
        // Example messages
        const examples = [
            "Congratulations! You've won a $1000 gift card. Click here to claim now!",
            "Hey, are we still meeting for lunch tomorrow?",
            "FREE! Click here to win an iPhone 15 Pro Max!",
            "Can you send me the report by end of day?"
        ];
        
        // Tab switching
        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Remove active from all buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName + '-tab').classList.add('active');
            event.target.closest('.tab-btn').classList.add('active');
            
            // Load data if needed
            if (tabName === 'dataset') loadDatasetStats();
            if (tabName === 'models') loadModelResults();
            if (tabName === 'analysis') loadAnalysis();
        }
        
        // Load example
        function loadExample(index) {
            document.getElementById('emailInput').value = examples[index];
        }
        
        // Clear input
        function clearInput() {
            document.getElementById('emailInput').value = '';
            document.getElementById('resultBox').style.display = 'none';
        }
        
        // Predict email
        async function predictEmail() {
            const message = document.getElementById('emailInput').value.trim();
            
            if (!message) {
                alert('Please enter an email message!');
                return;
            }
            
            // Show loading
            document.getElementById('loadingSpinner').style.display = 'block';
            document.getElementById('resultBox').style.display = 'none';
            
            try {
                const response = await fetch('/api/predict', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ message: message })
                });
                
                const data = await response.json();
                
                if (data.error) {
                    alert('Error: ' + data.error);
                    return;
                }
                
                displayResult(data);
                
            } catch (error) {
                alert('Error: ' + error.message);
            } finally {
                document.getElementById('loadingSpinner').style.display = 'none';
            }
        }
        
        // Display prediction result
        function displayResult(data) {
            const resultBox = document.getElementById('resultBox');
            const isSpam = data.prediction === 'spam';
            
            // Set colors and icon
            resultBox.className = 'result-box ' + data.prediction;
            resultBox.style.display = 'block';
            
            document.getElementById('resultIcon').innerHTML = isSpam ? 
                '<i class="fas fa-exclamation-triangle" style="color: #dc3545;"></i>' :
                '<i class="fas fa-check-circle" style="color: #28a745;"></i>';
            
            document.getElementById('resultLabel').textContent = isSpam ? 
                '⚠️ SPAM DETECTED!' : '✅ LEGITIMATE EMAIL';
            
            document.getElementById('resultConfidence').textContent = 
                `Confidence: ${data.confidence.toFixed(2)}%`;
            
            // Update probabilities
            document.getElementById('hamProb').textContent = 
                data.probabilities.ham.toFixed(1) + '%';
            document.getElementById('spamProb').textContent = 
                data.probabilities.spam.toFixed(1) + '%';
            
            // Update details
            document.getElementById('msgLength').textContent = data.message_length;
            document.getElementById('wordCount').textContent = data.word_count;
            
            // Update progress bar
            const progressFill = document.getElementById('progressFill');
            progressFill.className = 'progress-fill ' + data.prediction;
            progressFill.style.width = data.confidence.toFixed(0) + '%';
            progressFill.textContent = data.confidence.toFixed(1) + '%';
        }
        
        // Load dataset statistics
        async function loadDatasetStats() {
            try {
                const [datasetResp, textResp] = await Promise.all([
                    fetch('/api/dataset-stats'),
                    fetch('/api/text-stats')
                ]);
                
                const datasetStats = await datasetResp.json();
                const textStats = await textResp.json();
                
                // Update dataset stats
                document.getElementById('totalEmails').textContent = 
                    datasetStats.total_emails.toLocaleString();
                document.getElementById('hamCount').textContent = 
                    datasetStats.ham_count.toLocaleString();
                document.getElementById('spamCount').textContent = 
                    datasetStats.spam_count.toLocaleString();
                document.getElementById('spamPercentage').textContent = 
                    datasetStats.spam_percentage + '%';
                
                // Update text stats
                document.getElementById('avgLengthHam').textContent = 
                    Math.round(textStats.avg_length_ham);
                document.getElementById('avgLengthSpam').textContent = 
                    Math.round(textStats.avg_length_spam);
                document.getElementById('avgWordsHam').textContent = 
                    Math.round(textStats.avg_words_ham);
                document.getElementById('avgWordsSpam').textContent = 
                    Math.round(textStats.avg_words_spam);
                
            } catch (error) {
                console.error('Error loading dataset stats:', error);
            }
        }
        
        // Load model results
        async function loadModelResults() {
            try {
                const response = await fetch('/api/model-results');
                const results = await response.json();
                
                const grid = document.getElementById('modelStatsGrid');
                grid.innerHTML = '';
                
                const colors = ['', 'success', 'danger', 'info', 'warning'];
                let colorIndex = 0;
                
                for (const [model, metrics] of Object.entries(results)) {
                    const card = document.createElement('div');
                    card.className = 'stat-card ' + colors[colorIndex % colors.length];
                    card.innerHTML = `
                        <div class="stat-icon"><i class="fas fa-brain"></i></div>
                        <div class="stat-value">${(metrics.test_accuracy * 100).toFixed(2)}%</div>
                        <div class="stat-label">${model}</div>
                    `;
                    grid.appendChild(card);
                    colorIndex++;
                }
                
            } catch (error) {
                console.error('Error loading model results:', error);
            }
        }
        
        // Load analysis charts
        async function loadAnalysis() {
            try {
                const response = await fetch('/api/model-results');
                const results = await response.json();
                
                // Accuracy Chart
                const models = Object.keys(results);
                const testAccuracies = models.map(m => (results[m].test_accuracy * 100).toFixed(2));
                
                const ctx1 = document.getElementById('accuracyChart').getContext('2d');
                new Chart(ctx1, {
                    type: 'bar',
                    data: {
                        labels: models,
                        datasets: [{
                            label: 'Test Accuracy (%)',
                            data: testAccuracies,
                            backgroundColor: [
                                'rgba(52, 152, 219, 0.8)',
                                'rgba(46, 204, 113, 0.8)',
                                'rgba(231, 76, 60, 0.8)',
                                'rgba(243, 156, 18, 0.8)'
                            ],
                            borderColor: [
                                'rgb(52, 152, 219)',
                                'rgb(46, 204, 113)',
                                'rgb(231, 76, 60)',
                                'rgb(243, 156, 18)'
                            ],
                            borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 100
                            }
                        },
                        plugins: {
                            legend: {
                                display: false
                            }
                        }
                    }
                });
                
                // Train vs Test Chart
                const trainAccuracies = models.map(m => (results[m].train_accuracy * 100).toFixed(2));
                
                const ctx2 = document.getElementById('trainTestChart').getContext('2d');
                new Chart(ctx2, {
                    type: 'bar',
                    data: {
                        labels: models,
                        datasets: [{
                            label: 'Training Accuracy (%)',
                            data: trainAccuracies,
                            backgroundColor: 'rgba(52, 152, 219, 0.6)',
                            borderColor: 'rgb(52, 152, 219)',
                            borderWidth: 2
                        }, {
                            label: 'Testing Accuracy (%)',
                            data: testAccuracies,
                            backgroundColor: 'rgba(46, 204, 113, 0.6)',
                            borderColor: 'rgb(46, 204, 113)',
                            borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 100
                            }
                        }
                    }
                });
                
                // Load classification metrics
                const reportResp = await fetch('/api/classification-report');
                const report = await reportResp.json();
                
                const metricsTable = document.getElementById('metricsTable');
                metricsTable.innerHTML = `
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                                <th style="padding: 15px; text-align: left;">Class</th>
                                <th style="padding: 15px; text-align: center;">Precision</th>
                                <th style="padding: 15px; text-align: center;">Recall</th>
                                <th style="padding: 15px; text-align: center;">F1-Score</th>
                                <th style="padding: 15px; text-align: center;">Support</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="background: #d4edda;">
                                <td style="padding: 15px; font-weight: 600;">Ham (Legitimate)</td>
                                <td style="padding: 15px; text-align: center;">${(report.Ham.precision * 100).toFixed(2)}%</td>
                                <td style="padding: 15px; text-align: center;">${(report.Ham.recall * 100).toFixed(2)}%</td>
                                <td style="padding: 15px; text-align: center;">${(report.Ham['f1-score'] * 100).toFixed(2)}%</td>
                                <td style="padding: 15px; text-align: center;">${report.Ham.support}</td>
                            </tr>
                            <tr style="background: #f8d7da;">
                                <td style="padding: 15px; font-weight: 600;">Spam (Unwanted)</td>
                                <td style="padding: 15px; text-align: center;">${(report.Spam.precision * 100).toFixed(2)}%</td>
                                <td style="padding: 15px; text-align: center;">${(report.Spam.recall * 100).toFixed(2)}%</td>
                                <td style="padding: 15px; text-align: center;">${(report.Spam['f1-score'] * 100).toFixed(2)}%</td>
                                <td style="padding: 15px; text-align: center;">${report.Spam.support}</td>
                            </tr>
                            <tr style="background: #d1ecf1; font-weight: 700;">
                                <td style="padding: 15px;">Overall Accuracy</td>
                                <td colspan="4" style="padding: 15px; text-align: center; font-size: 1.2em;">
                                    ${(report.accuracy * 100).toFixed(2)}%
                                </td>
                            </tr>
                        </tbody>
                    </table>
                `;
                
            } catch (error) {
                console.error('Error loading analysis:', error);
            }
        }
        
        // Load dataset stats on page load
        window.addEventListener('load', () => {
            loadDatasetStats();
        });
    </script>
</body>
</html>
